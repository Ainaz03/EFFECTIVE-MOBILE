# Сравнение производительности Sync и Async парсера Excel-файлов

Проект реализует две версии парсера Excel-файлов: синхронную и асинхронную. Парсеры скачивают Excel-файлы с сайта, извлекают данные и сохраняют их в PostgreSQL. Также доступен скрипт, сравнивающий производительность двух подходов.

## Стек технологий

- Python 3.11
- pandas
- openpyxl
- aiohttp
- aiofiles
- SQLAlchemy [asyncio]
- asyncpg
- requests
- python-dotenv

---

## Установка и запуск

### Клонировать репозиторий

```bash
git clone https://github.com/Ainaz03/EFFECTIVE-MOBILE
````

### Перейти в директорию проекта

```bash
cd "EFFECTIVE-MOBILE/EFFECTIVE MOBILE - Tasks/Asyncio"
```

### Установить зависимости

```bash
pip install -r requirements.txt
```

---

## Настройка окружения

В каждом парсере необходимо создать и заполнить файл `.env`:

* `Async_parser/.env`
* `Sync_parser/.env`

Пример содержимого `.env`:

```env
DB_HOST=localhost
DB_PORT=5432
DB_NAME=your_database
DB_USER=your_user
DB_PASS=your_password
```

---

## Запуск парсеров

> Важно: запускать парсеры нужно с флагом `-m` из директории `Asyncio`, иначе возникнут ошибки импорта.

### Синхронный парсер

```bash
python -m Sync_parser.run_parser
```

### Асинхронный парсер

```bash
python -m Async_parser.run_parser
```

---

## Сравнение производительности

Скрипт `compare_parsers.py` запускает оба парсера последовательно, очищая базу данных перед каждым запуском и измеряет время обработки 10 файлов.

### Запуск сравнения

```bash
python compare_parsers.py
```

После выполнения будет создан файл `comparison_results.txt` с таблицей времени обработки, например:

```
┌────────────┬─────────────┬──────────────┐
│   Файл №   │   Sync (s)  │   Async (s)  │
├────────────┼─────────────┼──────────────┤
│     1      │     2.34    │     1.22     │
│     2      │     2.12    │     1.10     │
│    ...     │     ...     │     ...      │
├────────────┼─────────────┼──────────────┤
│   Всего    │    21.56    │    12.34     │
└────────────┴─────────────┴──────────────┘
```

---

## Полезные советы

* Рабочая директория должна быть `Asyncio`, а не подпапка с парсером.
* Если получаешь ошибку `ModuleNotFoundError: No module named ...`, убедись, что запускаешь с `-m`.
* Файл `.env` должен быть настроен отдельно для каждого парсера.